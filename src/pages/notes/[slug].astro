---
import { getCollection } from "astro:content";
import ColumnLayout from "@/layouts/ColumnLayout.astro";
import TocDesktop from "@/components/toc/TocDesktop.astro";
import TocMobile from "@/components/toc/TocMobile.astro";
import CollectionDetail from "@/components/CollectionDetail.astro";

export async function getStaticPaths() {
  const notes = await getCollection("notes");
  return notes.map((note) => {
    const id = note.id;
    const slug = id.split("/").pop();
    return {
      params: { slug },
      props: { note, id },
    };
  });
}

const { note, id } = Astro.props;

const pageTitle = note.data.title;
const description = note.data.description;
---

<ColumnLayout pageTitle={pageTitle} description={description}>
  <Fragment slot="main">
    <CollectionDetail post={note} parentPath="notes" id={id} />
  </Fragment>
  <Fragment slot="sidebar">
    <TocDesktop />
    <TocMobile />
  </Fragment>
</ColumnLayout>

<style lang="scss">
  @use "../../styles/mixin" as *;
  @use "../../styles/functions" as *;
  @use "../../styles/extends" as *;
</style>
